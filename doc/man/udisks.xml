<refentry id="udisks.8">
  <refentryinfo>
    <title>udisks</title>
    <date>March 2008</date>
    <productname>udisks</productname>
  </refentryinfo>

  <refmeta>
    <refentrytitle>udisks</refentrytitle>
    <manvolnum>8</manvolnum>
    <refmiscinfo class="version"></refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>udisks</refname>
    <refpurpose>Introduction to udisks</refpurpose>
  </refnamediv>

  <refsect1><title>DESCRIPTION</title>
    <para>
      udisks provides interfaces to enumerate and perform operations
      on storage devices. Any application can access the
      <citerefentry><refentrytitle>udisksd</refentrytitle><manvolnum>8</manvolnum></citerefentry>
      daemon via the name <emphasis>org.freedesktop.UDisks2</emphasis>
      on the system message bus. Some operations (such as formatting
      disks etc.) are restricted using
      <citerefentry><refentrytitle>polkit</refentrytitle><manvolnum>8</manvolnum></citerefentry>.
    </para>
  </refsect1>

  <refsect1><title>ACCESS CONTROL</title>
    <para>
      By default, logged-in users in active log-in sessions are
      permitted to perform operations (for example, mounting,
      unlocking or modifying) devices attached to the seat their
      session is on. Access-control is fine-grained and based on
      <citerefentry><refentrytitle>polkit</refentrytitle><manvolnum>8</manvolnum></citerefentry>,
      see the <quote><link
      linkend="udisks-polkit-actions">Authorization
      Checks</link></quote> chapter in the udisks documentation for
      more information (<ulink
      url="http://udisks.freedesktop.org/docs/latest/udisks-polkit-actions.html">available
      online here</ulink>).
    </para>
    <para>
      Note that the polkit actions ending in
      <literal>-system</literal> typically requires administrator
      authentication and are used for devices not considered
      <quote>removable</quote> (devices considered removable include
      USB attached storage, Flash media, optical discs etc.). The udev
      property <literal>UDISKS_SYSTEM</literal> can be used to
      override this on a per-device basis, see below.
    </para>
    <para>
      The <literal>x-udisks-auth</literal> option can be used in the
      <filename>/etc/fstab</filename> and
      <filename>/etc/crypttab</filename> files to specify that
      additional authorization is required to mount resp. unlock the
      device (typically requiring the user to authenticate as an
      administrator).
    </para>
  </refsect1>

  <refsect1><title>WHAT THE USER SEES</title>
    <para>
      udisks operates on the system-level and is not per se concerned
      with what a desktop user interface shows the user. For GNOME see
      these <ulink
      url="http://git.gnome.org/browse/gvfs/tree/monitor/udisks2/what-is-shown.txt">GVfs
      notes</ulink> about what is shown in the desktop user interface
      and how to influence it.
    </para>
  </refsect1>

  <refsect1>
    <title>DEVICE INFORMATION</title>
    <para>
      udisks relies on recent versions of
      <citerefentry><refentrytitle>udev</refentrytitle><manvolnum>7</manvolnum></citerefentry>
      and the Linux kernel. Influential device properties in the udev
      database include:
    </para>
    <variablelist>
      <varlistentry>
        <term><option>UDISKS_SYSTEM</option></term>
        <listitem>
          <para>
            If set, this overrides the value of the
            <link linkend="gdbus-property-org-freedesktop-UDisks2-Block.HintSystem">HintSystem</link> property.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>UDISKS_IGNORE</option></term>
        <listitem>
          <para>
            If set, this overrides the value of the
            <link linkend="gdbus-property-org-freedesktop-UDisks2-Block.HintIgnore">HintIgnore</link> property.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>UDISKS_AUTO</option></term>
        <listitem>
          <para>
            If set, this overrides the value of the
            <link linkend="gdbus-property-org-freedesktop-UDisks2-Block.HintAuto">HintAuto</link> property.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>UDISKS_NAME</option></term>
        <listitem>
          <para>
            The name to use for the device when presenting it in an user interface.
            This corresponds to the
            <link linkend="gdbus-property-org-freedesktop-UDisks2-Block.HintName">HintName</link> property.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>UDISKS_ICON_NAME</option></term>
        <listitem>
          <para>
            The icon to use for the device when presenting it in an user interface. If
            set, the name must adhere to the
            <ulink url="http://www.freedesktop.org/wiki/Specifications/icon-theme-spec">freedesktop.org icon theme specification</ulink>.
            This corresponds to the
            <link linkend="gdbus-property-org-freedesktop-UDisks2-Block.HintIconName">HintIconName</link> property.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_SEAT</option></term>
        <listitem>
          <para>
            The physical seat the device is attached to. If not set,
            <quote>seat0</quote> (the first seat) is assumed. The
            special value <quote>all</quote> means that the device
            should be available on all seats, e.g. available from
            login sessions running on any seat. This also means that
            special mount options and mount directory will be used so
            all users can access mounted filesystems from the device -
            for example, the device will be mounted in
            <filename>/media</filename> instead of
            <filename>/run/media/USER</filename>.
          </para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>
      For media and drive identification, the output of the probers
      supplied by
      <citerefentry><refentrytitle>udev</refentrytitle><manvolnum>7</manvolnum></citerefentry>
      (such as <command>cdrom_id</command>, <command>ata_id</command> and
      <command>scsi_id</command>) are used in addition to the
      following properties:
    </para>
    <variablelist>
      <varlistentry>
        <term><option>ID_DRIVE_THUMB</option></term>
        <listitem><para>The device is a thumb-drive with non-removable media (e.g. a USB stick).
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH</option></term>
        <listitem><para>The device is compatible with flash.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_CF</option></term>
        <listitem><para>The device is compatible with Compact Flash.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_MS</option></term>
        <listitem><para>The device is compatible with Memory Stick.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_SM</option></term>
        <listitem><para>The device is compatible with SmartMedia.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_SD</option></term>
        <listitem><para>The device is compatible with SecureDigital.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_SDHC</option></term>
        <listitem><para>The device is compatible with High-Capacity SecureDigital.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_SDXC</option></term>
        <listitem><para>The device is compatible with Extended-Capacity SecureDigital.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLASH_MMC</option></term>
        <listitem><para>The device is compatible with MultiMediaCard.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLOPPY</option></term>
        <listitem><para>The device is compatible with floppy disk.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLOPPY_ZIP</option></term>
        <listitem><para>The device is compatible with Zip.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_FLOPPY_JAZ</option></term>
        <listitem><para>The device is compatible with Jaz.
        </para></listitem>
      </varlistentry>
    </variablelist>
    <para>
      While the <literal>ID_DRIVE_*</literal> properties describe what
      kind of media the drive accepts (more than one property can be
      set) and correspond to the <link
      linkend="gdbus-property-org-freedesktop-UDisks2-Drive.MediaCompatibility">MediaCompatibility</link>
      property, the <option>ID_DRIVE_MEDIA_*</option> properties
      describe the current media in a device (typically only one of
      these properties are set) and correspond to the <link
      linkend="gdbus-property-org-freedesktop-UDisks2-Drive.Media">Media</link>
      property:
    </para>
    <variablelist>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH</option></term>
        <listitem><para>The physical media currently inserted into the device is flash.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_CF</option></term>
        <listitem><para>The physical media currently inserted into the device is Compact Flash.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_MS</option></term>
        <listitem><para>The physical media currently inserted into the device is Memory Stick.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_SM</option></term>
        <listitem><para>The physical media currently inserted into the device is SmartMedia.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_SD</option></term>
        <listitem><para>The physical media currently inserted into the device is SecureDigital.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_SDHC</option></term>
        <listitem><para>The physical media currently inserted into the device is High-Capacity SecureDigital.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_SDXC</option></term>
        <listitem><para>The physical media currently inserted into the device is Extended-Capacity SecureDigital.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLASH_MMC</option></term>
        <listitem><para>The physical media currently inserted into the device is MultiMediaCard.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLOPPY</option></term>
        <listitem><para>The physical media currently inserted into the device is floppy disk.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLOPPY_ZIP</option></term>
        <listitem><para>The physical media currently inserted into the device is Zip.
        </para></listitem>
      </varlistentry>
      <varlistentry>
        <term><option>ID_DRIVE_MEDIA_FLOPPY_JAZ</option></term>
        <listitem><para>The physical media currently inserted into the device is Jaz.
        </para></listitem>
      </varlistentry>

    </variablelist>
  </refsect1>

  <refsect1><title>API STABILITY</title>
    <para>
      udisks guarantees a stable D-Bus API within the same major
      version and this guarantee extends to the client-side
      library. Additionally several major versions of udisks can be
      installed and operate at the same time although interoperability
      may be limited - for example, a device mounted using the udisks
      1.x API may require additional authorization if attempting to
      unmount it through the the 2.x API.
    </para>
    <para>
      We do not anticipate breaking API but we do reserve the right to
      do so and if we do, we promise to bump the major version and
      ensure the new version of udisks is parallel-installable (except
      that tools and man pages from the old version may require a
      suffix to be parallel installable).
    </para>
    <para>
      udisks is not designed to be bundled with applications - it is
      software that operates on the system-level and requires deep
      integration with other system-level software.
    </para>
    <para>
      There is no guarantee that the
      <link linkend="udisksctl.1"><citerefentry><refentrytitle>udisksctl</refentrytitle><manvolnum>1</manvolnum></citerefentry></link>
      options and command-line switches will remain stable. Use the
      D-Bus API instead - either directly or via
      <citerefentry>
        <refentrytitle>dbus-send</refentrytitle><manvolnum>1</manvolnum>
      </citerefentry>.
    </para>
  </refsect1>

  <refsect1><title>AUDIENCE</title>
    <para>
      The intended audience of udisks include developers of
      higher-level layers of the operating system, for example the
      desktop shell (such as
      <ulink url="http://www.gnome.org">GNOME</ulink>)
      and disk management applications (e.g. GNOME's
      <ulink url="https://live.gnome.org/Design/Apps/Disks">Disks</ulink>
      application).  Software on this level typically depend on a specific
      (major) version of udisks and may even have support for previous
      versions of udisks or alternative interfaces performing the same
      role as udisks (such as the now deprecated hal daemon).
    </para>
    <para>
      While udisks provides a stable API and a clear upgrade path, it
      may not be appropriate for 3rd party applications to depend on
      it.  For example, if the operating system has switched to udisks
      2.x and your application is still using the udisks 1.x API, your
      application will not work unless udisks 1.x is installed. While
      this will still work (the user installing udisks 1.x before
      installing your application), it may not be desirable. Hence, if
      you do not want to tie yourself to a specific version of the
      operating system or desktop shell, you should not use
      udisks. Other viable options include
      <itemizedlist>
        <listitem>
          <para>
            Low-level guaranteed-stable APIs and commands such as e.g.
            <ulink url="http://en.wikipedia.org/wiki/Sysfs">sysfs</ulink>,
            <ulink url="http://www.freedesktop.org/software/systemd/libudev/">libudev</ulink>,
            <ulink url="http://www.kernel.org/doc/Documentation/filesystems/proc.txt">/proc/self/mountinfo</ulink> and
            <ulink url="http://en.wikipedia.org/wiki/Util-linux">util-linux</ulink>.
          </para>
        </listitem>
        <listitem>
          <para>
            High-level guaranteed-stable APIs such as <ulink url="http://developer.gnome.org/gio/stable/volume_mon.html">GVolumeMonitor</ulink>.
          </para>
        </listitem>
      </itemizedlist>
      In particular, if you are writing a desktop application, it is a
      much better idea to use e.g. GVolumeMonitor than udisks since
      this will make your application show the same devices as the
      desktop shell (e.g. file manager, file chooser and so on).
    </para>
  </refsect1>

  <refsect1><title>AUTHOR</title>
    <para>
      Written by David Zeuthen <email>zeuthen@gmail.com</email> with
      a lot of help from many others.
    </para>
  </refsect1>

  <refsect1>
    <title>BUGS</title>
    <para>
      Please send bug reports to either the distribution bug tracker
      or the upstream bug tracker at
      <ulink url="http://bugs.freedesktop.org/enter_bug.cgi?product=udisks"/>.
    </para>
  </refsect1>

  <refsect1>
    <title>SEE ALSO</title>
    <para>
      <citerefentry>
        <refentrytitle>udev</refentrytitle><manvolnum>7</manvolnum>
      </citerefentry>,
      <citerefentry>
        <refentrytitle>polkit</refentrytitle><manvolnum>8</manvolnum>
      </citerefentry>,
      <link linkend="udisksd.8"><citerefentry><refentrytitle>udisksd</refentrytitle><manvolnum>8</manvolnum></citerefentry></link>,
      <link linkend="udisksctl.1"><citerefentry><refentrytitle>udisksctl</refentrytitle><manvolnum>1</manvolnum></citerefentry></link>
    </para>
  </refsect1>
</refentry>
